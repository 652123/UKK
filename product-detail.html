<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detail Produk - Dazeon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- IMPORT CONFIG.JS AGAR CREDENTIALS SAMA DENGAN INDEX.HTML -->
    <script src="config.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <!-- Combine Poppins and Outfit imports -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700;900&family=Poppins:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.body.classList.add('loaded'); // Trigger transition
            // ... original DOMContentLoaded logic below ...
        });

        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                        heading: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            400: '#a78bfa',
                            500: '#8b5cf6',
                            600: '#7c3aed',
                            accent: '#d946ef',
                        }
                    },
                    animation: {
                        'gradient': 'gradient 8s linear infinite',
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        'gradient': {
                            '0%, 100%': {
                                'background-size': '200% 200%',
                                'background-position': 'left center'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'right center'
                            },
                        },
                        'float': {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* Page Transition Root */
        body {
            opacity: 0;
            transition: opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body.loaded {
            opacity: 1;
        }

        /* Typography Utilities */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        .font-heading {
            font-family: 'Outfit', sans-serif;
        }
    </style>
    <style>
        .size-btn.active {
            background-color: black;
            color: white;
            border-color: black;
        }

        /* Hide number input spinners */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* HIDE NAVBAR LOGIN BUTTON on this page */
        #login-btn-nav {
            display: none !important;
        }

        /* ANIMATIONS FROM INDEX */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.5, 0, 0, 1);
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .text-glow {
            text-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
        }

        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>

<body class="bg-[#050505] text-gray-100 font-sans antialiased selection:bg-brand-500 selection:text-white">

    <!-- NAV (Simple Version) -->
    <div id="navbar-container"></div>
    <script src="js/components/navbar.js"></script>

    <main class="min-h-screen bg-[#050505] relative overflow-hidden">
        <!-- Background Glow -->
        <div class="absolute top-0 left-1/4 w-96 h-96 bg-brand-500/10 rounded-full blur-[120px] pointer-events-none">
        </div>
        <div
            class="absolute bottom-0 right-1/4 w-96 h-96 bg-brand-accent/10 rounded-full blur-[120px] pointer-events-none">
        </div>

        <!-- Loading State -->
        <div id="loading-ui" class="min-h-screen flex items-center justify-center bg-[#050505] relative z-50">
            <div class="text-center">
                <div
                    class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-gray-800 border-t-brand-500 mb-4">
                </div>
                <p class="text-gray-400 font-medium text-sm tracking-wide animate-pulse">MEMUAT PRODUK...</p>
            </div>
        </div>

        <div id="product-content" class="hidden relative z-10">

            <!-- BREADCRUMB -->
            <div class="border-b border-white/5 bg-[#050505]/80 backdrop-blur-md sticky top-0 z-40">
                <div class="container mx-auto px-4 py-4">
                    <nav class="text-xs font-medium tracking-wide" id="breadcrumbs">
                        <a href="index.html" class="text-gray-500 hover:text-brand-400 transition">BERANDA</a>
                        <span class="mx-2 text-gray-700">/</span>
                        <span class="text-gray-300">PRODUK</span>
                    </nav>
                </div>
            </div>

            <!-- MAIN PRODUCT SECTION -->
            <div class="relative">
                <div class="container mx-auto px-4 py-8 lg:py-12 max-w-7xl">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-start">

                        <!-- Left: Product Image -->
                        <div class="space-y-4 sticky top-24">
                            <div
                                class="aspect-square bg-[#121212] rounded-3xl overflow-hidden relative group border border-white/5 shadow-[0_0_50px_rgba(0,0,0,0.5)] reveal glass">
                                <img id="p-img" src="" alt="Produk"
                                    class="w-full h-full object-cover object-center transition duration-700 group-hover:scale-110 opacity-90 group-hover:opacity-100">
                                <!-- Zoom Hint -->
                                <div
                                    class="absolute bottom-6 right-6 bg-black/50 backdrop-blur-md text-white text-xs px-4 py-2 rounded-full opacity-0 group-hover:opacity-100 transition border border-white/10 font-bold uppercase tracking-wider transform translate-y-2 group-hover:translate-y-0">
                                    <i class="fas fa-search-plus mr-2"></i> Zoom Image
                                </div>
                            </div>
                        </div>

                        <!-- Right: Product Details -->
                        <div class="flex flex-col">

                            <!-- Product Header -->
                            <div class="mb-8">
                                <h1 id="p-name"
                                    class="text-4xl md:text-5xl lg:text-6xl font-black text-white mb-4 leading-tight tracking-tight drop-shadow-xl reveal">
                                    Nama Produk
                                </h1>
                                <div class="flex flex-wrap items-center gap-4">
                                    <p id="p-price"
                                        class="text-2xl md:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-brand-400 to-brand-accent">
                                        Rp0</p>
                                    <span id="stock-badge"
                                        class="text-xs font-bold px-3 py-1.5 rounded-full ring-1 ring-inset">
                                        <!-- Dynamic -->
                                    </span>
                                </div>
                            </div>

                            <!-- Divider -->
                            <div class="h-px bg-gradient-to-r from-white/10 to-transparent mb-8"></div>

                            <!-- Quick Specs -->
                            <div class="grid grid-cols-3 gap-3 mb-8">
                                <div
                                    class="bg-[#121212] rounded-xl p-4 text-center border border-white/5 hover:border-brand-500/30 transition shadow-lg shadow-black/20">
                                    <p class="text-[10px] uppercase text-gray-500 mb-1 tracking-widest">Material</p>
                                    <p class="text-sm font-bold text-gray-200" id="p-material">-</p>
                                </div>
                                <div
                                    class="bg-[#121212] rounded-xl p-4 text-center border border-white/5 hover:border-brand-500/30 transition shadow-lg shadow-black/20">
                                    <p class="text-[10px] uppercase text-gray-500 mb-1 tracking-widest">Fit</p>
                                    <p class="text-sm font-bold text-gray-200" id="p-fit">-</p>
                                </div>
                                <div
                                    class="bg-[#121212] rounded-xl p-4 text-center border border-white/5 hover:border-brand-500/30 transition shadow-lg shadow-black/20">
                                    <p class="text-[10px] uppercase text-gray-500 mb-1 tracking-widest">Stok</p>
                                    <p class="text-sm font-bold text-gray-200" id="p-stock">0</p>
                                </div>
                            </div>

                            <!-- Size Selection -->
                            <div class="mb-8">
                                <div class="flex items-center justify-between mb-4">
                                    <label class="text-sm font-bold text-gray-300 uppercase tracking-widest">Pilih
                                        Ukuran</label>
                                    <button onclick="document.getElementById('size-guide').classList.toggle('hidden')"
                                        class="text-xs text-brand-400 hover:text-brand-300 transition flex items-center gap-1 group">
                                        <i class="fas fa-ruler"></i> <span class="group-hover:underline">Panduan
                                            Ukuran</span>
                                    </button>
                                </div>
                                <div id="size-options" class="flex flex-wrap gap-3 mb-3">
                                    <button onclick="selectSize(this, 'S')"
                                        class="size-btn h-12 w-14 border border-white/10 bg-[#121212] text-gray-400 rounded-xl font-bold text-sm hover:border-brand-500 hover:text-brand-400 transition flex items-center justify-center">S</button>
                                    <button onclick="selectSize(this, 'M')"
                                        class="size-btn h-12 w-14 border border-white/10 bg-[#121212] text-gray-400 rounded-xl font-bold text-sm hover:border-brand-500 hover:text-brand-400 transition flex items-center justify-center">M</button>
                                    <button onclick="selectSize(this, 'L')"
                                        class="size-btn h-12 w-14 border border-white/10 bg-[#121212] text-gray-400 rounded-xl font-bold text-sm hover:border-brand-500 hover:text-brand-400 transition flex items-center justify-center">L</button>
                                    <button onclick="selectSize(this, 'XL')"
                                        class="size-btn h-12 w-14 border border-white/10 bg-[#121212] text-gray-400 rounded-xl font-bold text-sm hover:border-brand-500 hover:text-brand-400 transition flex items-center justify-center">XL</button>
                                    <button onclick="selectSize(this, 'XXL')"
                                        class="size-btn h-12 w-14 border border-white/10 bg-[#121212] text-gray-400 rounded-xl font-bold text-sm hover:border-brand-500 hover:text-brand-400 transition flex items-center justify-center">XXL</button>
                                </div>
                                <p id="size-alert"
                                    class="text-red-400 text-xs hidden font-medium flex items-center gap-2 bg-red-500/10 p-2 rounded-lg border border-red-500/20">
                                    <i class="fas fa-exclamation-circle"></i> Mohon pilih ukuran terlebih dahulu.
                                </p>

                                <!-- Size Guide (Hidden by default) -->
                                <div id="size-guide"
                                    class="hidden mt-4 bg-[#121212] rounded-xl p-6 border border-white/5 shadow-2xl">
                                    <p class="text-xs font-bold text-gray-400 uppercase mb-4 tracking-widest">Panduan
                                        Ukuran (cm)</p>
                                    <table class="w-full text-xs text-gray-400">
                                        <thead class="text-brand-400 uppercase border-b border-white/10">
                                            <tr>
                                                <th class="py-3 text-left">Size</th>
                                                <th class="py-3 text-left">Lebar Dada</th>
                                                <th class="py-3 text-left">Panjang</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-white/5">
                                            <tr>
                                                <td class="py-3 font-bold text-white">S</td>
                                                <td class="py-3">48</td>
                                                <td class="py-3">68</td>
                                            </tr>
                                            <tr>
                                                <td class="py-3 font-bold text-white">M</td>
                                                <td class="py-3">50</td>
                                                <td class="py-3">70</td>
                                            </tr>
                                            <tr>
                                                <td class="py-3 font-bold text-white">L</td>
                                                <td class="py-3">52</td>
                                                <td class="py-3">72</td>
                                            </tr>
                                            <tr>
                                                <td class="py-3 font-bold text-white">XL</td>
                                                <td class="py-3">54</td>
                                                <td class="py-3">74</td>
                                            </tr>
                                            <tr>
                                                <td class="py-3 font-bold text-white">XXL</td>
                                                <td class="py-3">56</td>
                                                <td class="py-3">76</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="space-y-4 mt-auto pt-8 border-t border-white/5">
                                <!-- Quantity & Add to Cart -->
                                <div class="flex gap-4">
                                    <div
                                        class="flex items-center bg-[#121212] border border-white/10 rounded-xl overflow-hidden shrink-0">
                                        <button onclick="updateQty(-1)"
                                            class="w-12 h-14 text-gray-400 hover:text-white hover:bg-white/5 transition text-lg font-medium">âˆ’</button>
                                        <input id="qty-input" type="number" value="1" min="1"
                                            onchange="validateQty(this)"
                                            class="w-16 h-14 text-center font-bold text-white bg-transparent border-none focus:outline-none focus:ring-0">
                                        <button onclick="updateQty(1)"
                                            class="w-12 h-14 text-gray-400 hover:text-white hover:bg-white/5 transition text-lg font-medium">+</button>
                                    </div>
                                    <button onclick="contactAdmin()"
                                        class="w-14 h-14 rounded-xl border border-white/20 text-gray-400 hover:bg-brand-600 hover:text-white hover:border-brand-600 transition flex items-center justify-center shrink-0"
                                        title="Chat Admin">
                                        <i class="fas fa-comment-dots text-xl"></i>
                                    </button>
                                    <button onclick="addToCart(false)" id="btn-cart"
                                        class="flex-1 h-14 bg-[#121212] border border-white/20 text-white font-bold rounded-xl hover:bg-white hover:text-black hover:border-white transition-all text-sm uppercase tracking-wider flex items-center justify-center gap-3 group">
                                        <i class="fas fa-shopping-bag group-hover:scale-110 transition-transform"></i>
                                        <span class="hidden sm:inline">Keranjang</span>
                                    </button>
                                </div>

                                <!-- Buy Now -->
                                <button onclick="addToCart(true)" id="btn-buy-now"
                                    class="w-full h-14 bg-gradient-to-r from-brand-600 to-brand-accent text-white font-bold rounded-xl hover:shadow-[0_0_30px_rgba(139,92,246,0.4)] transition-all uppercase tracking-widest text-sm flex items-center justify-center gap-3 group relative overflow-hidden">
                                    <div
                                        class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-200%] group-hover:animate-shine">
                                    </div>
                                    <span>Beli Sekarang</span>
                                    <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                                </button>

                                <!-- Trust Badge -->
                                <p
                                    class="text-center text-[10px] uppercase tracking-widest text-gray-500 flex items-center justify-center gap-6 pt-4">
                                    <span class="flex items-center gap-2"><i
                                            class="fas fa-shield-alt text-brand-400"></i> Original</span>
                                    <span class="flex items-center gap-2"><i class="fas fa-bolt text-yellow-400"></i>
                                        Fast Delivery</span>
                                    <span class="flex items-center gap-2"><i class="fas fa-sync text-blue-400"></i>
                                        Easy Return</span>
                                </p>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <!-- PRODUCT INFO TABS -->
            <div class="mt-4">
                <div class="container mx-auto px-4 py-8 max-w-7xl">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

                        <!-- Specifications -->
                        <div class="lg:col-span-1">
                            <div class="bg-[#121212] rounded-2xl p-6 border border-white/5 sticky top-24 shadow-2xl">
                                <h3
                                    class="text-sm font-bold text-gray-200 uppercase tracking-widest mb-6 flex items-center gap-3 border-b border-white/5 pb-4">
                                    <i class="fas fa-list-ul text-brand-400"></i> Spesifikasi
                                </h3>
                                <div class="space-y-4 text-sm text-gray-400">
                                    <div class="flex justify-between py-2 border-b border-white/5">
                                        <span>Merek</span>
                                        <span class="font-bold text-gray-200">Dazeon Store</span>
                                    </div>
                                    <div class="flex justify-between py-2 border-b border-white/5">
                                        <span>Bahan</span>
                                        <span class="font-bold text-gray-200" id="spec-material">-</span>
                                    </div>
                                    <div class="flex justify-between py-2 border-b border-white/5">
                                        <span>Fit Type</span>
                                        <span class="font-bold text-gray-200" id="spec-fit">-</span>
                                    </div>
                                    <div class="flex justify-between py-2 border-b border-white/5">
                                        <span>Stok</span>
                                        <span class="font-bold text-gray-200" id="spec-stock">0</span>
                                    </div>
                                    <div class="flex justify-between py-2 border-b border-white/5">
                                        <span>Asal</span>
                                        <span class="font-bold text-gray-200">Indonesia</span>
                                    </div>
                                    <div class="flex justify-between py-2">
                                        <span>Dikirim Dari</span>
                                        <span class="font-bold text-gray-200">Kab Mojokerto</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Description -->
                        <div class="lg:col-span-2">
                            <div class="bg-[#121212] rounded-2xl p-8 border border-white/5 shadow-2xl">
                                <h3
                                    class="text-sm font-bold text-gray-200 uppercase tracking-widest mb-6 flex items-center gap-3 border-b border-white/5 pb-4">
                                    <i class="fas fa-align-left text-brand-400"></i> Deskripsi Produk
                                </h3>
                                <div
                                    class="prose prose-invert prose-p:text-gray-400 prose-headings:text-white max-w-none">
                                    <p class="leading-relaxed whitespace-pre-line text-sm" id="p-desc">
                                        Tidak ada deskripsi.
                                    </p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- REVIEW SECTION -->
            <div class="mt-4">
                <div class="container mx-auto px-4 py-8 max-w-7xl">
                    <h3 class="text-xl font-bold text-white mb-8 flex items-center gap-3">
                        <i class="fas fa-star text-yellow-500"></i> Ulasan Pembeli
                    </h3>

                    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

                        <!-- Rating Summary -->
                        <div class="lg:col-span-1">
                            <div
                                class="bg-gradient-to-br from-[#121212] to-[#0a0a0a] rounded-2xl p-8 text-center border border-white/5 sticky top-24 shadow-2xl">
                                <h4 id="avg-rating" class="text-6xl font-black text-white mb-2 tracking-tighter">0.0
                                </h4>
                                <div id="avg-stars" class="flex justify-center text-yellow-500 text-lg mb-4 gap-1">
                                    <i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i
                                        class="far fa-star"></i><i class="far fa-star"></i>
                                </div>
                                <p id="total-reviews" class="text-xs text-gray-500 font-bold uppercase tracking-widest">
                                    0 Ulasan</p>

                                <!-- Write Review Button -->
                                <div id="write-review-container" class="hidden mt-8">
                                    <button onclick="toggleReviewForm()"
                                        class="w-full py-4 bg-brand-600 text-white font-bold rounded-xl hover:bg-brand-500 transition text-sm uppercase tracking-wide border border-brand-500 shadow-lg shadow-brand-500/20">
                                        <i class="fas fa-pen mr-2"></i> Tulis Ulasan
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Review List -->
                        <div class="lg:col-span-3">

                            <!-- Review Form (Hidden) -->
                            <div id="review-form"
                                class="hidden mb-8 bg-[#121212] border border-white/10 p-6 rounded-2xl shadow-xl relative">
                                <button onclick="toggleReviewForm()"
                                    class="absolute top-4 right-4 text-gray-500 hover:text-red-500 transition">
                                    <i class="fas fa-times"></i>
                                </button>
                                <h4 class="font-bold text-lg text-white mb-6">Bagikan Pengalamanmu</h4>
                                <form onsubmit="submitReview(event)">
                                    <div class="mb-6">
                                        <label
                                            class="block text-xs font-bold uppercase text-gray-500 mb-3 tracking-wider">Rating</label>
                                        <div class="flex gap-3 text-3xl text-gray-700">
                                            <i class="fas fa-star cursor-pointer hover:text-yellow-500 transition duration-200"
                                                onclick="setRating(1)"></i>
                                            <i class="fas fa-star cursor-pointer hover:text-yellow-500 transition duration-200"
                                                onclick="setRating(2)"></i>
                                            <i class="fas fa-star cursor-pointer hover:text-yellow-500 transition duration-200"
                                                onclick="setRating(3)"></i>
                                            <i class="fas fa-star cursor-pointer hover:text-yellow-500 transition duration-200"
                                                onclick="setRating(4)"></i>
                                            <i class="fas fa-star cursor-pointer hover:text-yellow-500 transition duration-200"
                                                onclick="setRating(5)"></i>
                                        </div>
                                        <input type="hidden" id="review-rating" value="0" required>
                                    </div>
                                    <div class="mb-6">
                                        <label
                                            class="block text-xs font-bold uppercase text-gray-500 mb-3 tracking-wider">Ulasan</label>
                                        <textarea id="review-comment" rows="4" required
                                            class="w-full bg-[#0a0a0a] border border-white/10 rounded-xl p-4 text-sm text-gray-200 focus:ring-1 focus:ring-brand-500 focus:border-brand-500 outline-none resize-none transition"
                                            placeholder="Ceritakan kepuasan Anda terhadap produk ini..."></textarea>
                                    </div>
                                    <button type="submit" id="btn-submit-review"
                                        class="bg-brand-600 text-white px-8 py-3 rounded-xl font-bold text-sm hover:bg-brand-500 transition shadow-lg shadow-brand-600/20">
                                        Kirim Ulasan
                                    </button>
                                </form>
                            </div>

                            <!-- Reviews List -->
                            <div id="reviews-list" class="space-y-4">
                                <div class="text-center py-12 text-gray-500">
                                    <div
                                        class="w-8 h-8 border-2 border-white/10 border-t-brand-500 rounded-full animate-spin mx-auto mb-3">
                                    </div>
                                    Memuat ulasan...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RELATED PRODUCTS -->
            <div class="mt-8 py-12 border-t border-white/5">
                <div class="container mx-auto px-4 max-w-7xl">
                    <div class="flex items-center justify-between mb-8">
                        <h2 class="text-xl font-bold text-white tracking-wide">Produk Lainnya</h2>
                        <a href="index.html" class="text-sm text-brand-400 hover:text-brand-300 transition font-medium">
                            Lihat Semua <i class="fas fa-arrow-right ml-1"></i>
                        </a>
                    </div>
                    <div id="related-products" class="grid grid-cols-2 md:grid-cols-4 gap-4 lg:gap-6">
                        <div class="col-span-full text-center py-10">
                            <div
                                class="w-8 h-8 border-2 border-white/10 border-t-brand-500 rounded-full animate-spin mx-auto mb-2">
                            </div>
                            <p class="text-gray-500 text-sm">Memuat rekomendasi...</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </main>

    <script>
        // --- LOGIC RELATED PRODUCTS ---
        async function loadRelatedProducts(currentId) {
            try {
                // Ambil 4 produk acak yang bukan produk saat ini
                const { data, error } = await window.db
                    .from('products')
                    .select('*')
                    .neq('id', currentId)
                    .limit(4);

                if (error) throw error;

                const container = document.getElementById('related-products');
                if (!data || data.length === 0) {
                    container.innerHTML = '<p class="text-gray-500 col-span-full text-center">Tidak ada produk terkait.</p>';
                    return;
                }

                container.innerHTML = '';
                data.forEach(product => {
                    // Logic Gambar (Sama seperti main.js)
                    let imageUrl = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 300"%3E%3Crect fill="%231a1a1a" width="300" height="300"/%3E%3Ctext x="50%25" y="50%25" fill="%234b5563" font-size="16" text-anchor="middle" dy=".3em"%3ENo Image%3C/text%3E%3C/svg%3E';
                    if (product.image_url) {
                        if (product.image_url.startsWith('http')) {
                            imageUrl = product.image_url;
                        } else {
                            const { data: imgData } = window.db.storage.from('product-images').getPublicUrl(product.image_url);
                            imageUrl = imgData.publicUrl;
                        }
                    }

                    const html = `
                    <div class="bg-[#121212] rounded-xl shadow-lg hover:shadow-brand-500/10 hover:-translate-y-1 transition-all duration-300 overflow-hidden border border-white/5 group">
                        <a href="product-detail.html?id=${product.id}" class="block overflow-hidden relative aspect-[4/5] bg-[#0a0a0a]">
                            <img src="${imageUrl}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700 opacity-90 group-hover:opacity-100">
                        </a>
                        <div class="p-4">
                            <h3 class="text-sm font-bold text-gray-200 line-clamp-1 mb-1 group-hover:text-brand-400 transition-colors">${product.name}</h3>
                            <p class="text-sm font-bold text-white">Rp ${parseInt(product.price).toLocaleString('id-ID')}</p>
                        </div>
                    </div>`;
                    container.insertAdjacentHTML('beforeend', html);
                });

            } catch (err) {
                console.error("Related product error:", err);
                document.getElementById('related-products').innerHTML = '';
            }
        }
    </script>

    <script>
        // --- CONFIG & SUPABASE ---
        // Kita menggunakan window.db yang murni dari config.js
        // Pastikan config.js sudah diload di <head>
        // const supabase = ... (REMOVED due to SyntaxError: identifier already declared)

        // Cek koneksi
        if (!window.db) console.log("Menunggu config.js...");

        let currentProduct = null;
        let selectedSize = null;
        let currentUserId = null;

        // --- INIT ---
        async function init() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');

            if (!id) {
                await Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Produk tidak ditemukan/ID invalid.',
                    timer: 1500,
                    showConfirmButton: false
                });
                window.location.href = 'index.html';
                return;
            }

            try {
                // Fetch Produk
                const { data, error } = await window.db.from('products').select('*').eq('id', id).single();

                if (error) throw error;
                if (!data) throw new Error("Data produk kosong.");

                currentProduct = data;
                renderUI(data);
                checkUser();
                loadReviews(data.id); // Load Reviews
                loadRelatedProducts(data.id); // Load Related Products

            } catch (err) {
                console.error("Error init product:", err);
                document.getElementById('loading-ui').innerHTML = `
                    <div class='bg-red-50 p-6 rounded-lg inline-block'>
                        <p class='text-red-600 font-bold mb-2'>Gagal memuat produk</p>
                        <p class='text-sm text-red-500'>${err.message}</p>
                        <button onclick="location.reload()" class="mt-4 underline text-red-700">Coba Lagi</button>
                    </div>`;
            }
        }

        // --- RENDER UI ---
        function renderUI(p) {
            document.getElementById('loading-ui').classList.add('hidden');
            document.getElementById('product-content').classList.remove('hidden');

            // Trigger Animations
            setTimeout(() => {
                initScrollReveal();
                document.querySelectorAll('.reveal').forEach(el => el.classList.add('active'));
            }, 100);

            // Update UI Standard
            document.getElementById('p-name').innerText = p.name;
            document.getElementById('p-price').innerText = `Rp${p.price.toLocaleString('id-ID')}`;
            updateStockUI(p.stock); // Use helper for consistency

            // REALTIME SUBSCRIPTION
            window.db.channel(`public:product:${p.id}`)
                .on('postgres_changes', { event: 'UPDATE', schema: 'public', table: 'products', filter: `id=eq.${p.id}` }, (payload) => {
                    console.log("Realtime Stock Update:", payload.new.stock);
                    updateStockUI(payload.new.stock);
                    currentProduct.stock = payload.new.stock; // Update local state
                })
                .subscribe();

            // LOGIC BADGE STOK
            const badge = document.getElementById('stock-badge');
            if (p.stock > 0) {
                badge.innerText = "Ready Stock";
                badge.className = "text-xs font-bold text-green-600 bg-green-50 px-3 py-1.5 rounded-full";
            } else {
                badge.innerText = "Stok Habis";
                badge.className = "text-xs font-bold text-red-600 bg-red-50 px-3 py-1.5 rounded-full";
            }

            document.getElementById('p-desc').innerText = p.description || 'Tidak ada deskripsi.';

            // Setup Chat Context
            window.contactAdmin = () => {
                const params = new URLSearchParams({
                    product_id: p.id,
                    product_name: p.name,
                    product_price: p.price,
                    product_image: p.image_url // Assuming standard URL or handled by contact.html
                });
                // Fix image URL if it's a path
                let img = p.image_url;
                if (!img.startsWith('http')) {
                    img = window.db.storage.from('product-images').getPublicUrl(img).data.publicUrl;
                }
                params.set('product_image', img);

                window.location.href = `contact.html?${params.toString()}`;
            };

            document.getElementById('spec-stock').innerText = p.stock;
            document.getElementById('spec-material').innerText = p.material || 'Cotton Combed 24s';

            // Update Breadcrumbs
            const breadcrumbsEl = document.getElementById('breadcrumbs');
            if (breadcrumbsEl) {
                breadcrumbsEl.innerHTML = `
                        <a href="index.html" class="text-gray-400 hover:text-gray-900 transition">Beranda</a> 
                        <span class="mx-2 text-gray-300">/</span> 
                        <a href="index.html#produk" class="text-gray-400 hover:text-gray-900 transition">${p.category || 'Produk'}</a> 
                        <span class="mx-2 text-gray-300">/</span> 
                        <span class="text-gray-600 font-medium">${p.name}</span>
                    `;
            }

            // Dynamic specs
            document.getElementById('p-material').innerText = p.material || '-';
            // Also update the new bottom specs section
            // document.getElementById('spec-material').innerText = p.material || '-'; // This line is now redundant due to the update above

            document.getElementById('p-fit').innerText = p.fit || '-';
            document.getElementById('spec-fit').innerText = p.fit || '-';

            // document.getElementById('spec-stock').innerText = p.stock + " buah"; // This line is now redundant due to the update above

            // Handle Description (preserve newlines)
            const descElem = document.getElementById('p-desc');
            descElem.innerText = p.description || "Tidak ada deskripsi.";

            // Image
            // Gunakan helper yang konsisten jika ada, atau manual:
            let imgUrl = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 600"%3E%3Crect fill="%23f3f4f6" width="500" height="600"/%3E%3Ctext x="50%25" y="50%25" fill="%239ca3af" font-size="16" text-anchor="middle" dy=".3em"%3ENo Image%3C/text%3E%3C/svg%3E';
            if (p.image_url) {
                if (p.image_url.startsWith('http')) imgUrl = p.image_url;
                else {
                    const { data } = window.db.storage.from('product-images').getPublicUrl(p.image_url);
                    imgUrl = data.publicUrl;
                }
            }
            document.getElementById('p-img').src = imgUrl;

            // Stok Logic
            const btnCart = document.getElementById('btn-cart');
            const btnBuy = document.getElementById('btn-buy-now');

            if (p.stock < 1) {
                btnCart.disabled = true;
                btnCart.innerText = "Stok Habis";
                btnCart.classList.add('opacity-50', 'cursor-not-allowed', 'bg-gray-200', 'border-gray-200');
                btnCart.classList.remove('hover:bg-gray-50', 'border-black');

                btnBuy.style.display = 'none'; // Sembunyikan tombol beli jika habis

                document.getElementById('qty-input').value = 0;
            } else {
                // Set Max Input
                document.getElementById('qty-input').max = p.stock;
            }
        }

        function updateStockUI(stock) {
            document.getElementById('p-stock').innerText = stock;
            document.getElementById('spec-stock').innerText = stock;

            const badge = document.getElementById('stock-badge');
            const btnCart = document.getElementById('btn-cart');
            const btnBuy = document.getElementById('btn-buy-now');
            const qtyInput = document.getElementById('qty-input');

            if (stock > 0) {
                badge.innerText = "Ready Stock";
                badge.className = "text-xs font-bold text-green-600 bg-green-50 px-3 py-1.5 rounded-full";

                btnCart.disabled = false;
                btnCart.innerHTML = `<i class="fas fa-shopping-bag group-hover:scale-110 transition-transform"></i> <span class="hidden sm:inline">Keranjang</span>`;
                btnCart.classList.remove('opacity-50', 'cursor-not-allowed', 'bg-gray-200', 'border-gray-200');
                btnCart.classList.add('hover:bg-white', 'hover:text-black');

                btnBuy.style.display = 'flex';
                qtyInput.max = stock;
                if (parseInt(qtyInput.value) > stock) qtyInput.value = stock;

            } else {
                badge.innerText = "Stok Habis";
                badge.className = "text-xs font-bold text-red-600 bg-red-50 px-3 py-1.5 rounded-full";

                btnCart.disabled = true;
                btnCart.innerText = "Stok Habis";
                btnCart.classList.add('opacity-50', 'cursor-not-allowed', 'bg-gray-200', 'border-gray-200');

                btnBuy.style.display = 'none';
                qtyInput.value = 0;
            }
        }

        // --- INTERACTION ---
        window.selectSize = (btn, size) => {
            // Reset all
            document.querySelectorAll('.size-btn').forEach(b => {
                b.classList.remove('bg-brand-600', 'text-white', 'border-brand-500', 'ring-2', 'ring-brand-500/50');
                // Ensure default state
                b.classList.add('hover:border-black');
            });

            // Set Active
            btn.classList.remove('hover:border-black');
            btn.classList.add('bg-brand-600', 'text-white', 'border-brand-500', 'ring-2', 'ring-brand-500/50');

            selectedSize = size;
            document.getElementById('size-alert').classList.add('hidden');
        };

        window.updateQty = (change) => {
            if (!currentProduct || currentProduct.stock < 1) return;
            const input = document.getElementById('qty-input');
            let val = parseInt(input.value) || 1;
            val += change;
            if (val < 1) val = 1;
            if (val > currentProduct.stock) val = currentProduct.stock;
            input.value = val;
        };

        window.validateQty = (input) => {
            if (!currentProduct) return;
            let val = parseInt(input.value);
            if (isNaN(val) || val < 1) val = 1;
            if (val > currentProduct.stock) val = currentProduct.stock;
            input.value = val;
        };

        // --- ADD TO CART / BUY NOW ---
        window.addToCart = async (isBuyNow = false) => {

            // 1. Cek Login
            if (!currentUserId) {
                Swal.fire({
                    icon: 'info',
                    title: 'Login Diperlukan',
                    text: 'Anda harus login untuk memproses pesanan.',
                    showCancelButton: true,
                    confirmButtonText: 'Login Sekarang',
                    confirmButtonColor: '#111827'
                }).then((result) => {
                    if (result.isConfirmed) window.location.href = 'index.html';
                });
                return;
            }

            // 2. Cek Ukuran
            if (!selectedSize) {
                document.getElementById('size-alert').classList.remove('hidden');
                document.getElementById('size-options').scrollIntoView({ behavior: 'smooth', block: 'center' });
                Swal.fire({
                    icon: 'warning',
                    title: 'Pilih Ukuran',
                    text: 'Mohon pilih ukuran terlebih dahulu.',
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000
                });
                return;
            }

            // 3. Validasi Qty Akhir
            let qty = parseInt(document.getElementById('qty-input').value);
            if (isNaN(qty) || qty < 1) qty = 1;
            if (qty > currentProduct.stock) {
                Swal.fire({
                    icon: 'error',
                    title: 'Stok Tidak Cukup',
                    text: `Maaf, stok hanya tersedia ${currentProduct.stock} pcs.`,
                    confirmButtonColor: '#111827'
                });
                document.getElementById('qty-input').value = currentProduct.stock;
                return;
            }

            // 4. UI Feedback
            const btn = isBuyNow ? document.getElementById('btn-buy-now') : document.getElementById('btn-cart');
            const originalText = btn.innerHTML;

            btn.innerHTML = `<i class="fas fa-circle-notch fa-spin"></i> Memproses...`;
            btn.disabled = true;

            try {
                // LOGIKA "BELI SEKARANG" (Direct Buy)
                // Fitur: Tidak mencampur dengan keranjang database, dan tidak menyimpannya jika batal.
                if (isBuyNow) {
                    const directItem = {
                        product_id: currentProduct.id,
                        quantity: qty,
                        size: selectedSize,
                        name: currentProduct.name,
                        price: currentProduct.price,
                        stock: currentProduct.stock // Simpan stok untuk validasi di checkout
                    };

                    localStorage.setItem('direct_buy_item', JSON.stringify(directItem));
                    // Pass source param for smart back navigation
                    window.location.href = `checkout.html?from_product=${currentProduct.id}`;
                    return; // STOP Here, jangan simpan ke DB
                }

                // LOGIKA "KERANJANG" (Simpan ke DB)
                // Cek existence
                const { data: exist, error: fetchError } = await window.db
                    .from('cart_items')
                    .select('id, quantity')
                    .eq('user_id', currentUserId)
                    .eq('product_id', currentProduct.id)
                    .eq('size', selectedSize)
                    .maybeSingle();

                if (fetchError) throw fetchError;

                if (exist) {
                    // Update
                    await window.db.from('cart_items')
                        .update({ quantity: exist.quantity + qty })
                        .eq('id', exist.id);
                } else {
                    // Insert
                    await window.db.from('cart_items').insert([{
                        user_id: currentUserId,
                        product_id: currentProduct.id,
                        quantity: qty,
                        size: selectedSize
                    }]);
                }

                // Feedback UI untuk Keranjang
                btn.disabled = false;
                btn.innerHTML = `<i class="fas fa-check"></i> Masuk Keranjang`;
                btn.classList.remove('bg-white', 'text-black');
                btn.classList.add('bg-black', 'text-white');

                // SweetAlert Success
                Swal.fire({
                    icon: 'success',
                    title: 'Berhasil!',
                    text: 'Produk masuk ke keranjang.',
                    showConfirmButton: false,
                    timer: 1500
                });

                checkUser(); // Update counter cart

                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.add('bg-white', 'text-black');
                    btn.classList.remove('bg-black', 'text-white');
                }, 2000);

            } catch (err) {
                console.error("Cart Error:", err);
                Swal.fire({
                    icon: 'error',
                    title: 'Terjadi Kesalahan',
                    text: err.message,
                    confirmButtonColor: '#d33'
                });
                btn.disabled = false;
                btn.innerHTML = originalText;
            }
        };

        async function checkUser() {
            const { data } = await window.db.auth.getSession();
            if (data.session) {
                currentUserId = data.session.user.id;
                // Show Write Review Button
                document.getElementById('write-review-container').classList.remove('hidden');

                // Update Cart Count
                const { data: cart } = await window.db.from('cart_items').select('quantity').eq('user_id', currentUserId);
                if (cart) {
                    const total = cart.reduce((a, b) => a + b.quantity, 0);
                    const countElem = document.getElementById('cart-count');
                    countElem.innerText = total;
                    if (total > 0) countElem.classList.remove('scale-0');
                }
            } else {
                currentUserId = null;
                document.getElementById('write-review-container').classList.add('hidden');
            }
        }

        // --- REVIEWS LOGIC ---

        async function loadReviews(productId) {
            const container = document.getElementById('reviews-list');
            try {
                // Fetch reviews
                const { data: reviews, error } = await window.db
                    .from('reviews')
                    .select('*')
                    .eq('product_id', productId)
                    .order('created_at', { ascending: false });

                if (error) throw error;

                if (!reviews || reviews.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-10 bg-[#0a0a0a] rounded-xl border border-dashed border-white/10">
                            <i class="far fa-comment-dots text-4xl text-gray-700 mb-3 block"></i>
                            <p class="text-gray-400 font-medium">Belum ada ulasan.</p>
                            <p class="text-sm text-gray-500">Jadilah yang pertama mereview produk ini!</p>
                        </div>`;
                    updateRatingStats([]);
                    return;
                }

                updateRatingStats(reviews);

                // Fetch Profile Names for these reviews
                // Note: user_id is in reviews. We need to map it to names in 'profiles' table.
                const userIds = [...new Set(reviews.map(r => r.user_id))];
                const { data: profiles } = await window.db
                    .from('profiles')
                    .select('id, name, avatar_url')
                    .in('id', userIds);

                const profileMap = {};
                if (profiles) {
                    profiles.forEach(p => profileMap[p.id] = p);
                }

                // Render List
                container.innerHTML = reviews.map((r, index) => {
                    const profile = profileMap[r.user_id] || { name: 'Pengguna' };
                    const name = profile.name || 'Pengguna';
                    const date = new Date(r.created_at).toLocaleDateString('id-ID', { year: 'numeric', month: 'long', day: 'numeric' });
                    const isOwnReview = currentUserId === r.user_id;

                    // Avatar Logic
                    let avatarHtml = '';
                    if (profile.avatar_url) {
                        let avUrl = profile.avatar_url;
                        if (!avUrl.startsWith('http')) {
                            const { data: imgData } = window.db.storage.from('product-images').getPublicUrl(avUrl);
                            avUrl = imgData.publicUrl;
                        }
                        avatarHtml = `<img src="${avUrl}" class="w-12 h-12 rounded-full object-cover border-2 border-brand-500/20 shadow-lg group-hover:border-brand-500 transition-colors">`;
                    } else {
                        const initial = name.charAt(0).toUpperCase();
                        const colors = ['bg-red-500', 'bg-blue-500', 'bg-green-500', 'bg-purple-500', 'bg-orange-500'];
                        const bg = colors[name.length % colors.length];
                        avatarHtml = `
                        <div class="w-12 h-12 rounded-full ${bg} flex items-center justify-center font-bold text-white shadow-lg text-lg border-2 border-white/5">
                            ${initial}
                        </div>`;
                    }

                    // Generate Stars HTML
                    let starsHtml = '';
                    for (let i = 1; i <= 5; i++) {
                        if (i <= r.rating) starsHtml += '<i class="fas fa-star text-yellow-400 text-sm drop-shadow"></i>';
                        else starsHtml += '<i class="far fa-star text-gray-600 text-sm"></i>';
                    }

                    // Stagger Animation Delay
                    const delay = index * 100;

                    return `
                    <div class="flex gap-5 p-6 rounded-2xl bg-[#0a0a0a] border border-white/5 hover:border-brand-500/30 transition-all duration-300 hover:shadow-[0_4px_20px_rgba(139,92,246,0.1)] group reveal" style="transition-delay: ${delay}ms">
                        <div class="flex-shrink-0">
                            ${avatarHtml}
                        </div>
                        <div class="flex-grow">
                            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2">
                                <div class="flex items-center gap-2">
                                    <h5 class="font-bold text-white text-base group-hover:text-brand-400 transition-colors">${name}</h5>
                                    <span class="text-[10px] uppercase font-bold text-green-400 bg-green-500/10 px-2 py-0.5 rounded-full border border-green-500/20 flex items-center gap-1">
                                        <i class="fas fa-check-circle"></i> Verified
                                    </span>
                                </div>
                                <div class="flex items-center gap-3 mt-1 sm:mt-0">
                                    <span class="text-xs text-gray-500 font-medium">${date}</span>
                                    ${isOwnReview ? `
                                        <button onclick="deleteReview('${r.id}')" class="w-8 h-8 flex items-center justify-center rounded-full bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition-all shadow-lg hover:shadow-red-500/30" title="Hapus Ulasan">
                                            <i class="fas fa-trash-alt text-xs"></i>
                                        </button>` : ''}
                                </div>
                            </div>
                            <div class="mb-3 flex items-center gap-2 bg-[#121212] w-fit px-3 py-1.5 rounded-lg border border-white/5">
                                <div class="flex gap-0.5">${starsHtml}</div>
                                <span class="text-xs text-gray-400 font-bold ml-1">${r.rating}.0</span>
                            </div>
                            <p class="text-gray-300 text-sm leading-relaxed font-light tracking-wide">${r.comment || ''}</p>
                        </div>
                    </div>
                    `;
                }).join('');

                // Re-trigger animations for new elements
                setTimeout(() => {
                    if (window.revealObserver) {
                        document.querySelectorAll('#reviews-list .reveal').forEach(el => window.revealObserver.observe(el));
                    }
                }, 100);

            } catch (err) {
                console.error("Load Reviews Error:", err);
                container.innerHTML = '<p class="text-red-500 text-sm">Gagal memuat ulasan.</p>';
            }
        }

        async function deleteReview(reviewId) {
            const result = await Swal.fire({
                title: 'Hapus Ulasan?',
                text: "Ulasan yang dihapus tidak dapat dikembalikan.",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Ya, Hapus',
                cancelButtonText: 'Batal'
            });

            if (!result.isConfirmed) return;

            try {
                const { error } = await window.db.from('reviews').delete().eq('id', reviewId);
                if (error) throw error;

                Swal.fire('Terhapus', 'Ulasan berhasil dihapus.', 'success');
                loadReviews(currentProduct.id); // Reload list

            } catch (err) {
                console.error("Delete Review Error:", err);
                Swal.fire('Gagal', 'Gagal menghapus ulasan.', 'error');
            }
        }


        function updateRatingStats(reviews) {
            const count = reviews.length;
            document.getElementById('total-reviews').innerText = `${count} Ulasan`;

            if (count === 0) {
                document.getElementById('avg-rating').innerText = '0.0';
                document.getElementById('avg-stars').innerHTML = '<i class="far fa-star"></i>'.repeat(5);
                return;
            }

            const sum = reviews.reduce((a, b) => a + b.rating, 0);
            const avg = (sum / count).toFixed(1);

            document.getElementById('avg-rating').innerText = avg;

            // Render Review Stars Summary
            let starsHtml = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= Math.round(avg)) starsHtml += '<i class="fas fa-star"></i>';
                else starsHtml += '<i class="far fa-star text-gray-300"></i>';
            }
            document.getElementById('avg-stars').innerHTML = starsHtml;
        }

        // --- FORM LOGIC ---
        let currentRating = 0;

        function toggleReviewForm() {
            const form = document.getElementById('review-form');
            form.classList.toggle('hidden');
        }

        window.setRating = (val) => {
            currentRating = val;
            document.getElementById('review-rating').value = val;
            // Visual Update
            const stars = document.querySelectorAll('#review-form .fa-star');
            stars.forEach((s, idx) => {
                if (idx < val) s.classList.add('text-yellow-400');
                else s.classList.remove('text-yellow-400');
            });
        }

        window.submitReview = async (e) => {
            e.preventDefault();

            if (!currentUserId) {
                Swal.fire('Error', 'Silakan login dulu.', 'error');
                return;
            }

            if (currentRating === 0) {
                Swal.fire('Rating Kosong', 'Silakan berikan bintang 1-5.', 'warning');
                return;
            }

            const comment = document.getElementById('review-comment').value;
            const btn = document.getElementById('btn-submit-review');
            const originalText = btn.innerText;

            btn.disabled = true;
            btn.innerText = 'Mengirim...';

            try {
                const { error } = await window.db.from('reviews').insert([{
                    product_id: currentProduct.id,
                    user_id: currentUserId,
                    rating: currentRating,
                    comment: comment
                }]);

                if (error) throw error;

                // Success
                Swal.fire('Terima Kasih', 'Ulasan Anda berhasil dikirim!', 'success');
                toggleReviewForm();

                // Reset Form
                document.getElementById('review-comment').value = '';
                setRating(0);

                // Reload Reviews
                loadReviews(currentProduct.id);

            } catch (err) {
                console.error("Submit Review Error:", err);
                Swal.fire('Gagal', err.message, 'error');
            } finally {
                btn.disabled = false;
                btn.innerText = originalText;
            }
        }

        // --- SCROLL REVEAL ANIMATION ---
        function initScrollReveal() {
            const reveals = document.querySelectorAll('.reveal');
            window.revealObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                    }
                });
            }, { threshold: 0.1 });

            reveals.forEach(el => window.revealObserver.observe(el));
        }

        // Start
        init();
    </script>
</body>

</html>